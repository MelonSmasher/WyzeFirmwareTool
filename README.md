# Wyze Firmware Tool

A simple tool to handle some mundane tasks that are required when modifying Wyze camera firmware.

## What does it do?

This tool downloads, unpacks, mods, and repacks Wyze firmware files.

## Camera Support

* Wyze Cam v2

I only have a Wyze Cam v2 to mess around with. If you have a device you're willing to potentially brick feel free to
mess around with this.

## Mods

Below are the mods this tool will enable

* The `-u` / `--usb-ethernet` switch enables USB ethernet adapter support for ASIX based adapters such as [this one](https://www.amazon.com/gp/product/B0863YJB8W/).
* The `-d` / `--disable-wlan` switch disables wireless on the camera. This switch implies the `-u` switch and enables USB ethernet.
* The `-n` / `--nfs-sdcard` switch enables a hack that uses an NFS server as your SD Card. This option requires that you supply NFS server info when prompted.
* The `-t` / `--telnet-server` switch enables a persistent telnet server on the camera. This option requires that you set a root password, you'll be prompted.
* Custom user supplied mods. The tool will pause to allow you to make any custom modifications tht you'd like. The tool will resume when any key is pressed in the terminal. This step can be skipped with the `-y` / `--no-extra-mods` switch.

More to come!

### A note about NFS

Unfortunately at this time in order for the camera to use your NFS share you'll need an SD card inserted in the camera to fool the camera.
I have not figured out how to emulate an SD card with the NFS share, but instead bind mounted the `record` and `time_lapse` directories with directories on the NFS server.

# Dangers

## WyzeHacks

There is a great mod for Wyze cameras called [WyzeHacks](https://github.com/HclX/WyzeHacks). It's actually what inspired this project.
Unfortunately there are some incompatibilities between firmware generated by this project and the hacks in that repository.
I've bricked two cameras trying to combine the two, and have since given up on trying to make them work together.
Be advised you need to pick one or the other, and if you go with WyzeHacks ensure you have flashed a stock firmware prior to enabling the hacks.

## You'll shoot your eye out kid!

A serious heads up! Modifying firmware and flashing modified firmware on your device can brick it.
That means you could be holding a $25 - $100 paperweight if something goes wrong!
Please consider the risks before proceeding!

**I'm NOT responsible if your device turns into an overpriced rock, lights on fire, or anything in between!**

# Pre-Built Firmware

Please build your own firmware! Since you'll need to set your own telnet password and NFS connection info, there is no point for me to provide prebuilt firmware.
Check out the section below on *Generating Your Own Firmware*.

# Generate Your Own Firmware

## Setup

I've only tested this on Ubuntu 20.

### System Prerequisites

Install the following with your package manager:

* python3
* pip
* u-boot-tools
* mtd-utils

### Install

```bash
git clone https://github.com/MelonSmasher/WyzeFirmwareTool.git
pip install -r requirements.txt
```

### Usage

This program requires sudo to manage the JFFS2 image.

#### Modify a specific firmware version

Pick a version number
from [this page](https://wyzelabs.zendesk.com/hc/en-us/articles/360024852172-Release-Notes-Firmware).

```bash
sudo ./wyzefwtool -f <firmware-version> --usb-ethernet --telnet-server --nfs-sdcard --no-extra-mods
# E.G: sudo ./wyzefwtool -f 4.9.6.218 --usb-ethernet --telnet-server --nfs-sdcard --no-extra-mods
```

#### Modify the RTSP firmware

To modify the [official RTSP firmware](https://wyzelabs.zendesk.com/hc/en-us/articles/360026245231-Wyze-Cam-RTSP), run
the following:

```bash
sudo ./wyzefwtool --rtsp --usb-ethernet --telnet-server --nfs-sdcard --no-extra-mods
```

#### All command options

```bash
usage: wyzefwtool [-h] [-f [FIRMWARE_VERSION]] [-r] [-u] [-d] [-t] [-n] [-y]

optional arguments:
  -h, --help            show this help message and exit
  -f [FIRMWARE_VERSION], --firmware-version [FIRMWARE_VERSION]
                        The version number of the firmware to modify
  -r, --rtsp            Download the RTSP firmware. If used the Firmware Version argument is ignored.
  -u, --usb-ethernet    Enable USB Ethernet support for ASIX based ethernet adapters.
  -d, --disable-wlan    Disabled the wifi connection. Requires that you enable USB ethernet support.
  -t, --telnet-server   Enable persistent telnet server on the camera. Requires that you set a root password.
  -n, --nfs-sdcard      Enables the NFS SDCard hack. An NFS share is used as a virtual SD card. You will be prompted for NFS info.
  -y, --no-extra-mods   The tool will not wait for you to make extra custom modifications.
```
